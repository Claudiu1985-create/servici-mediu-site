<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Galerie lucrări — Clean and Plant 2004 S.R.L.</title>
  <meta name="description" content="Galerie cu proiecte Clean and Plant 2004: plantări, spații verzi, lucrări forestiere, curățenie industrială.">
  <link rel="stylesheet" href="style_Version3.css" />
  <link rel="icon" href="/favicon.ico" sizes="any">
  <meta property="og:title" content="Galerie — Clean and Plant 2004 S.R.L.">
  <meta property="og:description" content="Vezi lucrările noastre recente.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://cleanandplant2004.com/galerie_Version4.html">
  <meta property="og:image" content="https://cleanandplant2004.com/images/og-gallery.jpg">
</head>
<body>
  <header class="main-header">
    <a href="index.html" class="brand" aria-label="Acasă">
      <img src="images/logo.png" class="logo" alt="Logo Clean and Plant 2004 S.R.L.">
    </a>
    <nav>
      <ul>
        <li><a href="index.html#despre">Despre</a></li>
        <li><a href="index.html#servicii">Servicii</a></li>
        <li><a href="galerie_Version4.html" aria-current="page">Galerie lucrări</a></li>
        <li><a href="index.html#echipa">Echipa</a></li>
        <li><a href="index.html#contact-ro">Contact</a></li>
      </ul>
    </nav>
  </header>

  <section class="section">
    <h2>Galerie lucrări</h2>
    <p>Proiecte recente — click pe imagine pentru mărire. Folosește <kbd>←</kbd>/<kbd>→</kbd> pentru navigare și <kbd>Esc</kbd> pentru închidere.</p>

    <div id="gallery" class="gallery-grid" aria-live="polite"></div>

    <div class="pagination" aria-label="Paginare galerie">
      <button id="prevPage" class="page-btn" disabled>‹ Înapoi</button>
      <span id="pageInfo" class="page-info">Pagina 1/1</span>
      <button id="nextPage" class="page-btn" disabled>Înainte ›</button>
    </div>
  </section>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-label="Imagine mărită">
    <a href="#" class="lb-close" id="lbCloseBtn" aria-label="Închide">×</a>
    <a class="lb-prev" id="lbPrev" href="#" aria-label="Înapoi">‹</a>
    <figure class="lb-content">
      <div class="spinner" id="lbSpinner" aria-hidden="true"></div>
      <img id="lbImg" alt="" />
      <figcaption id="lbCaption">
        <h3 id="lbTitle">—</h3>
        <p id="lbDesc">—</p>
      </figcaption>
      <a id="lbDownload" class="btn-download" href="#" download>⬇ Descarcă</a>
    </figure>
    <a class="lb-next" id="lbNext" href="#" aria-label="Înainte">›</a>
  </div>

  <footer class="footer">
    <span>&copy; 2024 Clean and Plant 2004 S.R.L. | Toate drepturile rezervate</span>
  </footer>

  <script>
    // ====== Config ======
    // Adaugă aici câte imagini ai (1..N). Pentru >30 poze, paginarea se activează automat.
    const TOTAL_IMAGES = 60;           // setează la numărul real de poze
    const PER_PAGE = 18;               // câte carduri pe pagină
    // Texte demo pentru legende; poți personaliza pe index (1-based)
    const CAPTIONS = {
      1:{t:'Plantare puieți', d:'Reîmpădurire pe 2 ha cu stejar pedunculat.'},
      2:{t:'Spații verzi', d:'Tundere gard viu, cosit, colectare resturi.'},
      3:{t:'Lucrări forestiere', d:'Toaletare arbori maturi pentru siguranță.'},
      4:{t:'Curățenie industrială', d:'Curățare hale și spații de producție.'},
      5:{t:'Amenajări peisagistice', d:'Aranjamente florale și structuri.'},
      6:{t:'Proiecte ecologice', d:'Campanii de plantare și educație.'},
      7:{t:'Îngrijirea parcurilor', d:'Curățare alei și elemente decorative.'},
      8:{t:'Tăiere controlată', d:'Intervenții pe arbori periculoși.'},
      9:{t:'Lucrări de sezon', d:'Pregătire pentru iarnă.'}
      // restul vor primi titluri generice
    };

    // ====== Helpers ======
    const $ = sel => document.querySelector(sel);
    const galleryEl = $('#gallery');
    const pageInfo = $('#pageInfo');
    const prevBtn = $('#prevPage');
    const nextBtn = $('#nextPage');

    let currentPage = 1;
    const totalPages = Math.max(1, Math.ceil(TOTAL_IMAGES / PER_PAGE));

    function imgPaths(i){
      // returnează căi pentru webp + jpg
      return {
        webp: `images/${i}.webp`,
        jpg:  `images/${i}.jpg`,
        alt: CAPTIONS[i]?.t || `Lucrare ${i}`
      };
    }

    function renderPage(page=1){
      currentPage = Math.min(Math.max(1, page), totalPages);
      const start = (currentPage-1)*PER_PAGE + 1;
      const end   = Math.min(TOTAL_IMAGES, start + PER_PAGE - 1);

      galleryEl.innerHTML = '';
      for(let i=start;i<=end;i++){
        const {webp, jpg, alt} = imgPaths(i);
        const card = document.createElement('a');
        card.className = 'gallery-card';
        card.href = '#lightbox';
        card.dataset.index = i;
        card.innerHTML = `
          <picture>
            <source srcset="${webp}" type="image/webp" />
            <img src="${jpg}" alt="${alt}" loading="lazy">
          </picture>
        `;
        card.addEventListener('click', (e) => openLightbox(i, e.currentTarget.querySelector('img')));
        galleryEl.appendChild(card);
      }

      pageInfo.textContent = `Pagina ${currentPage}/${totalPages}`;
      prevBtn.disabled = (currentPage===1);
      nextBtn.disabled = (currentPage===totalPages);
    }

    prevBtn.addEventListener('click', () => { renderPage(currentPage-1); window.scrollTo({top:0,behavior:'smooth'}); });
    nextBtn.addEventListener('click', () => { renderPage(currentPage+1); window.scrollTo({top:0,behavior:'smooth'}); });

    // ====== Lightbox ======
    const lb = $('#lightbox');
    const lbImg = $('#lbImg');
    const lbTitle = $('#lbTitle');
    const lbDesc = $('#lbDesc');
    const lbDownload = $('#lbDownload');
    const lbSpinner = $('#lbSpinner');
    const lbPrev = $('#lbPrev');
    const lbNext = $('#lbNext');
    const lbCloseBtn = $('#lbCloseBtn');

    let currentIndex = 1;

    function openLightbox(i, thumbImg){
      currentIndex = i;
      updateLightbox();
      // focus pentru accesibilitate
      lb.style.display = 'flex';
      lb.setAttribute('aria-hidden', 'false');
      lbCloseBtn.focus();
      // prevenim scroll pagină în spate
      document.body.style.overflow = 'hidden';
    }

    function closeLightbox(){
      lb.style.display = 'none';
      lb.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = '';
      history.replaceState(null, '', window.location.pathname); // elimină #lightbox
    }

    function updateLightbox(){
      const {webp, jpg} = imgPaths(currentIndex);
      const cap = CAPTIONS[currentIndex] || {t:`Lucrare ${currentIndex}`, d:'Imagine din portofoliu.'};

      lbSpinner.style.display = 'block';
      lbImg.style.opacity = '0';

      // preferă WebP, fallback pe JPG
      const testImg = new Image();
      testImg.onload = () => {
        lbImg.src = testImg.src;
        lbImg.onload = () => {
          lbSpinner.style.display = 'none';
          lbImg.style.opacity = '1';
        };
      };
      testImg.onerror = () => {
        lbImg.src = jpg;
        lbImg.onload = () => {
          lbSpinner.style.display = 'none';
          lbImg.style.opacity = '1';
        };
      };
      testImg.src = webp;

      lbTitle.textContent = cap.t;
      lbDesc.textContent  = cap.d;
      lbDownload.href = jpg; // descarcă JPG (compatibilitate)
      lbPrev.onclick = (e)=>{ e.preventDefault(); navigate(-1); };
      lbNext.onclick = (e)=>{ e.preventDefault(); navigate(1); };
      lbCloseBtn.onclick = (e)=>{ e.preventDefault(); closeLightbox(); };
    }

    function navigate(dir){
      currentIndex += dir;
      if(currentIndex < 1) currentIndex = TOTAL_IMAGES;
      if(currentIndex > TOTAL_IMAGES) currentIndex = 1;
      updateLightbox();
    }

    // Tastatură: ←/→/Esc
    document.addEventListener('keydown', (e)=>{
      if(lb.style.display === 'flex'){
        if(e.key === 'ArrowLeft')  navigate(-1);
        if(e.key === 'ArrowRight') navigate(1);
        if(e.key === 'Escape')     closeLightbox();
      }
    });

    // Închidere la click pe background (în afara figurei)
    lb.addEventListener('click', (e)=>{
      if(e.target === lb) closeLightbox();
    });

    // Init
    renderPage(1);
  </script>
</body>
</html>
